(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{31:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),s=n(1),a=n.n(s),c=(n(3),n(8)),i=n.n(c),l=n(11),u=n.n(l);n(16);function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,e,n,r,o,s,a){try{var c=t[s](a),i=c.value}catch(t){return void n(t)}c.done?e(i):Promise.resolve(i).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var s=t.apply(e,n);function a(t){d(s,r,o,a,c,"next",t)}function c(t){d(s,r,o,a,c,"throw",t)}a(void 0)})}}var m={components:{VueCtkDateTimePicker:u.a},metaInfo:function(){return{title:"Réservation"}},layout:"frontend",created:function(){var t=h(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.$store.getters["shows/shows"].length<1)){t.next=5;break}return this.$store.commit("loading/SET_LOADING",!0),t.next=4,this.$store.dispatch("shows/fetchShows");case 4:this.$store.commit("loading/SET_LOADING",!1);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),mounted:function(){var t=h(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.selectedShow=this.$store.getters["shows/show"];case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),data:function(){return{showModal:!1,selectedShow:{},selectedPerformance:null,selectedDate:null,selectedTable:null,form:new i.a({performance:""})}},computed:{loading:function(){return this.$store.getters["loading/loading"]},shows:function(){return this.$store.getters["shows/shows"]},activeShows:function(){return this.$store.getters["shows/shows"].filter(function(t){return 1==t.is_active})},performances:function(){return this.$store.getters["performances/performances"]},performance:function(){return this.$store.getters["performances/performance"]},performancesByShow:function(){var t=this,e=[];for(var n in this.performances)this.performances.hasOwnProperty(n)&&null!=this.performances[n]&&e.push(this.performances[n]);return e.filter(function(e){return e.show_id===t.selectedShow.id})},performancesByShowByDay:function(){var t=this;return this.performancesByShow.filter(function(e){return a()(e.date).format("YYYY-MM-DD")===t.selectedDate})},performancesDates:function(){return this.performancesByShow.map(function(t){return a()(t.date).format("YYYY-MM-DD")})},planTables:function(){return this.$store.getters["planTables/planTables"]},nextPerformances:function(){return this.performancesByShow.filter(function(t){return a()(t.date)>=a()()}).map(function(t){return a()(t.date).format("YYYY-MM-DD")}).sort().reduce(function(t,e){return t.includes(e)?t:[].concat(f(t),[e])},[]).splice(0,3)}},methods:{selectShow:function(){var t=h(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$store.commit("loading/SET_LOADING",!0),this.selectedShow=e,t.next=4,this.$store.commit("shows/SET_SHOW",e);case 4:return t.next=6,this.$store.dispatch("performances/fetchPerformancesByShow",{showId:this.selectedShow.id});case 6:this.$store.commit("loading/SET_LOADING",!1);case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),selectDate:function(t){this.selectedDate=t},selectPerformance:function(t){this.selectedPerformance=t,this.$router.push("/reservations/".concat(t.id))},updateTableColor:function(t){console.log("updateTableColor: ",t);var e=t.table_svg_id,n=t.color;SVG.get(e).fill(n)}}},p=(n(337),n(2)),v=Object(p.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("b-row",{staticClass:"justify-content-center my-2"},[n("b-col",{staticClass:"my-1",attrs:{cols:"12"}},[n("h3",{staticClass:"text-center"},[t._v("Réservez vos places en ligne dès maintenant!")]),t._v(" "),n("h4",{staticClass:"text-center"},[t._v("Choisissez un spectacle:")])]),t._v(" "),n("b-col",{attrs:{cols:"12"}},[n("b-row",{staticClass:"justify-content-center align-items-center"},[t.loading?n("b-spinner",{attrs:{variant:"primary",label:"Spinning"}}):t._l(t.activeShows,function(e){return n("b-col",{key:e.id,staticClass:"text-center",attrs:{cols:"12",md:"4"}},[n("span",{staticClass:"box",class:[t.selectedShow.id===e.id?"active":""],on:{click:function(n){return t.selectShow(e)}}},[t._v("\n        \t\t\t\t\t"+t._s(e.name)+"\n        \t\t\t\t")])])})],2)],1)],1),t._v(" "),t.selectedShow.id?n("b-row",{staticClass:"justify-content-center align-items-center my-2"},[n("b-col",{staticClass:"my-3",attrs:{cols:"12"}},[n("h4",{staticClass:"text-center my-4"},[t._v("Choisissez une représentation:")]),t._v(" "),n("p",[t._v("Nos 3 prochaines dates:\n\t\t\t\t\t"),t._v(" "),t.loading?n("b-spinner",{attrs:{variant:"primary",label:"Spinning"}}):t._l(t.nextPerformances,function(e){return n("span",{key:e.id,staticClass:"badge badge-pill",class:[t.selectedDate===e?"active":""],on:{click:function(n){t.selectedDate=e}}},[t._v("\n\t\t\t\t\t\t"+t._s(t._f("moment")(e,"dddd, Do MMMM YYYY"))+"\n\t\t\t\t\t")])})],2)]),t._v(" "),n("b-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[n("VueCtkDateTimePicker",{attrs:{label:"Choisir une date",inline:"","only-date":"",format:"YYYY-MM-DD",formatted:"YYYY-MM-DD",color:"#9ACD32","button-color":"#9ACD32","button-now-translation":"Aujourd'hui","enabled-dates":t.performancesDates},on:{input:t.selectDate},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1),t._v(" "),n("b-col",{staticClass:"text-center",attrs:{cols:"12",md:"6"}},[t.selectedDate?n("div",[n("h4",[t._v("Représentations du jour:")]),t._v(" "),t._l(t.performancesByShowByDay,function(e){return n("div",{key:e.id},[n("span",{staticClass:"box",on:{click:function(n){return t.selectPerformance(e)}}},[n("small",[t._v(t._s(t._f("moment")(e.date,"dddd, Do MMMM YYYY ")))]),t._v(" "),n("b",[t._v(t._s(t._f("moment")(e.date,"HH:mm")))])])])})],2):t._e()])],1):t._e()],1)},[],!1,null,"a25f4fe4",null);e.default=v.exports},337:function(t,e,n){"use strict";var r=n(69);n.n(r).a},338:function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".box[data-v-a25f4fe4] {\n  display: inline-block;\n  border: 2px solid #9ACD32;\n  margin: 1rem;\n  padding: 0.6rem 1rem;\n  border-radius: 2rem;\n  background-color: #fff;\n  color: #9ACD32;\n}\n.box[data-v-a25f4fe4]:hover {\n  background-color: #9ACD32;\n  color: #fff;\n  cursor: pointer;\n}\n.box.active[data-v-a25f4fe4] {\n  background-color: #9ACD32;\n  color: #fff;\n}\n.badge-pill[data-v-a25f4fe4] {\n  background-color: #fff;\n  color: #9ACD32;\n  border: 1px solid #9ACD32;\n  margin: 0 0.5rem;\n  padding: 0.5rem;\n}\n.badge-pill[data-v-a25f4fe4]:hover {\n  background-color: #9ACD32;\n  color: #fff;\n  cursor: pointer;\n}\n.badge-pill.active[data-v-a25f4fe4] {\n  background-color: #9ACD32;\n  color: #fff;\n}",""])},69:function(t,e,n){var r=n(338);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(7)(r,o);r.locals&&(t.exports=r.locals)}}]);