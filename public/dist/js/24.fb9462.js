(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{301:function(n,t,e){"use strict";var r=e(55);e.n(r).a},302:function(n,t,e){(n.exports=e(6)(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/* >>>.table th {\r\n\t\tvertical-align: middle;\r\n\t}\r\n\t>>>.table td {\r\n\t\tvertical-align: middle;\r\n\t} */\r\n/* .nowrap {\r\n        white-space:nowrap;\r\n    } */\n.disabled[data-v-48cf3764]:hover {\r\n    cursor: not-allowed;\n}\r\n",""])},55:function(n,t,e){var r=e(302);"string"==typeof r&&(r=[[n.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};e(7)(r,a);r.locals&&(n.exports=r.locals)},85:function(n,t,e){"use strict";e.r(t);var r=e(0),a=e.n(r);function s(n){return function(n){if(Array.isArray(n)){for(var t=0,e=new Array(n.length);t<n.length;t++)e[t]=n[t];return e}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(n,t,e,r,a,s,o){try{var i=n[s](o),c=i.value}catch(n){return void e(n)}i.done?t(c):Promise.resolve(c).then(r,a)}function i(n){return function(){var t=this,e=arguments;return new Promise(function(r,a){var s=n.apply(t,e);function i(n){o(s,r,a,i,c,"next",n)}function c(n){o(s,r,a,i,c,"throw",n)}i(void 0)})}}var c={layout:"frontend",created:function(){var n=i(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}(),mounted:function(){var n=i(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.authUser){n.next=4;break}if(!(this.$store.getters["planSeats/userSeats"].length<1)){n.next=4;break}return n.next=4,this.$store.dispatch("planSeats/fetchUserSeats",{userId:this.authUser.id});case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),data:function(){return{iban:"1234 5678 9012 3456",postal_account:"01-23456-78",fields:[{key:"seat_number",label:"N° de place",sortable:!0},{key:"table.plan.performance.date",label:"Date",sortable:!0},{key:"status",label:"Statut",sortable:!0},{key:"price",label:"Prix",sortable:!0},{key:"show_details",label:"Détails",sortable:!1},{key:"actions",label:"Actions",sortable:!1}],loading:!1}},computed:{authUser:function(){return this.$store.getters["auth/user"]},userSeats:function(){return this.$store.getters["planSeats/userSeats"]},shoppingCart:function(){return[].concat(s(this.$store.getters["shoppingCart/shoppingCart"]),s(this.userSeats))},totalPrice:function(){return this.shoppingCart.reduce(function(n,t){return n+(t.price||0)},0)/100},preReservations:function(){return this.shoppingCart.filter(function(n){return"pre_reservation"===n.status})}},methods:{formattedStatus:function(n){switch(n){case"pre_reservation":return"Pré-reservation";case"confirmation_pending":return"En attente de réception du paiement";case"reservation_confirmed":return"Réservation confirmée";case"reservation_rejected":return"Réservation rejetée";default:return"Status non spécifié"}},deletePlanSeatPreReservation:function(){var n=i(a.a.mark(function n(t){var e;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.$bvModal.msgBoxConfirm("Etes-vous sûr de vouloir supprimer la pré-réservation de la place N° ".concat(t.seat_number,"?"),{okTitle:"OK",cancelTitle:"Annuler"});case 3:if(e=n.sent,console.log("value: ",e),!e){n.next=10;break}return console.log("deletePlanSeatReservation: ",t.id),n.next=9,this.$store.dispatch("planSeats/deletePlanSeatPreReservation",{planSeatId:t.id});case 9:this.$noty.success("La réservation a été annulée avec succès.");case 10:n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("error: ",n.t0),this.$noty.error("Nous sommes désolés. Une erreur est survenue et l'opération n'a pas pu être complétée.");case 16:case"end":return n.stop()}},n,this,[[0,12]])}));return function(t){return n.apply(this,arguments)}}(),deletePlanSeatConfirmedReservation:function(){var n=i(a.a.mark(function n(t){var e;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.$bvModal.msgBoxConfirm("Etes-vous sûr de vouloir supprimer la réservation de la place N° ".concat(t.seat_number,"?"),{okTitle:"OK",cancelTitle:"Annuler"});case 3:if(e=n.sent,console.log("value: ",e),!e){n.next=10;break}return console.log("deleteReservation: ",t.id),n.next=9,this.$store.dispatch("planSeats/deletePlanSeatConfirmedReservation",{planSeatId:t.id});case 9:this.$noty.success("La réservation a été annulée avec succès.");case 10:n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("error: ",n.t0),this.$noty.error("Nous sommes désolés. Une erreur est survenue et l'opération n'a pas pu être complétée.");case 16:case"end":return n.stop()}},n,this,[[0,12]])}));return function(t){return n.apply(this,arguments)}}(),confirmPlanSeatReservation:function(){var n=i(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.loading=!0,n.next=4,this.$store.dispatch("planSeats/confirmPlanSeatReservation",{shoppingCart:this.shoppingCart});case 4:this.loading=!1,this.$noty.success("Votre pré-réservation a été confirmée. Vous allez recevoir un e-mail de confirmation."),n.next=13;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("error: ",n.t0),this.loading=!1,this.$noty.error("Nous sommes désolés. Une erreur est survenue et l'opération n'a pas pu être complétée.");case 13:case"end":return n.stop()}},n,this,[[0,8]])}));return function(){return n.apply(this,arguments)}}()}},l=(e(301),e(2)),u=Object(l.a)(c,function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("b-container",[e("h1",{staticClass:"text-center mb-4"},[n._v("Mon panier")]),n._v(" "),n.preReservations.length>0&&n.authUser?e("b-alert",{attrs:{show:"",variant:"info"}},[n._v("\n            Vous avez "+n._s(n.preReservations.length)+" billets en pré-réservation. Veuillez confirmer votre réservation en appuyant sur le bouton correspondant.\n        ")]):n._e(),n._v(" "),n.preReservations.length>0&&!n.authUser?e("b-alert",{attrs:{show:"",variant:"info"}},[n._v(n._s(n.preReservations.length)+" billets en pré-réservation. Veuillez d'abord vous connecter/enregistrer, puis confirmer votre réservation.\n            "),e("router-link",{attrs:{to:"/login"}},[n._v("Login →")])],1):n._e(),n._v(" "),n.shoppingCart.length>0?e("b-table",{attrs:{items:n.shoppingCart,fields:n.fields,striped:"",responsive:"sm"},scopedSlots:n._u([{key:"cell(seat_number)",fn:function(t){return[e("b",{staticClass:"text-info"},[n._v(n._s(t.item.seat_number))])]}},{key:"cell(table.plan.performance.date)",fn:function(t){return[t.item.table.plan?e("span",[n._v("\n                    "+n._s(n._f("moment")(t.item.table.plan.performance.date,"dddd Do MMM YYYY HH:mm"))+"\n                ")]):n._e()]}},{key:"cell(status)",fn:function(t){return[n._v("\n                "+n._s(n.formattedStatus(t.item.status))+"\n            ")]}},{key:"cell(price)",fn:function(t){return[n._v(" "+n._s(parseInt(t.item.price)/100)+" CHF ")]}},{key:"cell(actions)",fn:function(t){return["pre_reservation"===t.item.status?e("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return n.deletePlanSeatPreReservation(t.item)}}},[n._v("Annuler ma pré-réservation")]):n._e(),n._v(" "),"confirmation_pending"===t.item.status?e("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return n.deletePlanSeatConfirmedReservation(t.item)}}},[n._v("Supprimer ma réservation")]):n._e()]}},{key:"cell(show_details)",fn:function(t){return[e("b-button",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:t.toggleDetails}},[n._v(" "+n._s(t.detailsShowing?"Cacher":"Montrer")+" détails ")])]}},{key:"row-details",fn:function(t){return[e("b-card",[e("b-row",{staticClass:"mb-2"},[e("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[e("b",[n._v("Spectacle:")])]),n._v(" "),e("b-col",[n._v(n._s(t.item.table.plan.performance.name))])],1),n._v(" "),e("b-row",{staticClass:"mb-2"},[e("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[e("b",[n._v("Lieu:")])]),n._v(" "),e("b-col",[n._v(n._s(t.item.table.plan.performance.location))])],1),n._v(" "),e("b-row",{staticClass:"mb-2"},[e("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[e("b",[n._v("Dernière modification:")])]),n._v(" "),e("b-col",[n._v(n._s(n._f("moment")(t.item.updated_at,"from","now")))])],1),n._v(" "),e("b-row",{staticClass:"justify-content-center mb-2"},[e("b-button",{attrs:{size:"sm"},on:{click:t.toggleDetails}},[n._v("Cacher détails")])],1)],1)]}}],null,!1,2580857831)},[n._v(" "),n._v(" "),n._v(" "),n._v(" "),n._v(" "),n._v(" "),e("template",{slot:"bottom-row"},[e("td",{attrs:{colspan:"3"}},[e("b",[n._v("Total restant à payer")])]),n._v(" "),e("td",[e("b",[n._v(n._s(n.totalPrice)+" CHF")])]),n._v(" "),e("td",{attrs:{colspan:"2"}})])],2):e("b-alert",{attrs:{show:"",variant:"info"}},[n._v("Aucune réservation effectuée pour le moment.")]),n._v(" "),e("div",[e("b-row",{staticClass:"justify-content-center my-4"},[e("b-button",{attrs:{variant:"primary",disabled:!n.authUser||n.preReservations.length<1||n.loading},on:{click:n.confirmPlanSeatReservation}},[n._v("Confirmer "+n._s(n.preReservations.length>1?"mes pré-réservations":"ma pré-réservation")+" "),e("font-awesome-icon",{attrs:{icon:"check-circle",size:"1x"}})],1)],1),n._v(" "),e("br"),e("br"),n._v(" "),n.authUser?e("b-row",{staticClass:"justify-content-center my-2"},[e("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"20rem"},attrs:{title:"Nos coordonnées bancaires:",tag:"article"}},[e("b-card-text",[e("p",[n._v("\n                            Théatre la parenthèse"),e("br"),n._v("\n                            Compte postal: "+n._s(n.postal_account)+" "),e("br"),n._v("\n                            IBAN: "+n._s(n.iban)+"\n                        ")])])],1)],1):n._e()],1)],1)},[],!1,null,"48cf3764",null);t.default=u.exports}}]);